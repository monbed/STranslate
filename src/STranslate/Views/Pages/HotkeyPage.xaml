<ui:Page
    x:Class="STranslate.Views.Pages.HotkeyPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cnvt="clr-namespace:STranslate.Converters"
    xmlns:control="clr-namespace:STranslate.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:ikw="http://schemas.inkore.net/lib/ui/wpf"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
    xmlns:vm="clr-namespace:STranslate.ViewModels.Pages"
    Title="Hotkey"
    d:DataContext="{d:DesignInstance Type=vm:HotkeyViewModel,
                                     IsDesignTimeCreatable=False}"
    d:DesignHeight="1000"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <DockPanel Margin="20,10,20,12">
            <TextBlock Style="{DynamicResource {x:Static ui:ThemeKeys.SubtitleTextBlockStyleKey}}" Text="{DynamicResource Hotkeys}" />

            <ui:AutoSuggestBox
                x:Name="PART_AutoSuggestBox"
                MinWidth="200"
                MaxWidth="500"
                HorizontalAlignment="Right"
                DockPanel.Dock="Right"
                PlaceholderText="{DynamicResource SearchFunction}"
                ToolTip="{DynamicResource SearchFunctionToolTip}"
                ToolTipService.InitialShowDelay="200"
                ToolTipService.Placement="Top">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="TextChanged">
                        <i:InvokeCommandAction
                            Command="{Binding TextChangedCommand}"
                            EventArgsConverter="{cnvt:EventArgsConverter}"
                            EventArgsConverterParameter="{Binding ElementName=PART_AutoSuggestBox}"
                            PassEventArgsToCommand="True" />
                    </i:EventTrigger>
                    <i:EventTrigger EventName="SuggestionChosen">
                        <i:InvokeCommandAction
                            Command="{Binding SuggestionChosenCommand}"
                            EventArgsConverter="{cnvt:EventArgsConverter}"
                            EventArgsConverterParameter="{Binding ElementName=PART_AutoSuggestBox}"
                            PassEventArgsToCommand="True" />
                    </i:EventTrigger>
                    <i:EventTrigger EventName="QuerySubmitted">
                        <i:InvokeCommandAction
                            Command="{Binding QuerySubmittedCommand}"
                            EventArgsConverter="{cnvt:EventArgsConverter}"
                            EventArgsConverterParameter="{Binding ElementName=PART_ScrollViewer}"
                            PassEventArgsToCommand="True" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ui:AutoSuggestBox.QueryIcon>
                    <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.Search_20_Regular}" />
                </ui:AutoSuggestBox.QueryIcon>
            </ui:AutoSuggestBox>
        </DockPanel>

        <ui:ScrollViewerEx x:Name="PART_ScrollViewer" Grid.Row="1">
            <ikw:SimpleStackPanel Margin="20,10" Spacing="4">
                <TextBlock
                    Margin="0,0,0,5"
                    Style="{DynamicResource BodyStrongTextBlockStyle}"
                    Text="{DynamicResource GlobalHotkeys}" />

                <ui:SettingsCard Description="{DynamicResource Hotkey_IncrementalTranslateDescription}" Header="{DynamicResource Hotkey_IncrementalTranslate}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.TextIndentIncrease_20_Regular}" />
                    </ui:SettingsCard.HeaderIcon>

                    <Button Command="{Binding IncrementalTranslateKeyCommand}" Content="{Binding HotkeySettings.IncrementalTranslateKey, Converter={cnvt:StringConverter}}">
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Border
                                    x:Name="PART_InnerBorder"
                                    Padding="10,5"
                                    Background="{DynamicResource {x:Static ui:ThemeKeys.SystemControlBackgroundAccentBrushKey}}"
                                    BorderThickness="1"
                                    CornerRadius="5">
                                    <TextBlock Foreground="{DynamicResource {x:Static ui:ThemeKeys.TextFillColorInverseBrushKey}}" Text="{Binding}" />
                                </Border>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type Button}}, Path=IsMouseOver}" Value="True">
                                        <Setter TargetName="PART_InnerBorder" Property="Background" Value="{DynamicResource SystemAccentColorLight1Brush}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type Button}}, Path=IsPressed}" Value="True">
                                        <Setter TargetName="PART_InnerBorder" Property="Background" Value="{DynamicResource SystemAccentColorDark1Brush}" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>
                </ui:SettingsCard>

                <control:CardGroup>
                    <ui:SettingsCard Description="{DynamicResource Hotkey_OpenSTranslateDescription}" Header="{DynamicResource Hotkey_OpenSTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.WindowAd_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.OpenWindowHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.OpenWindowHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.OpenWindowHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_OpenSTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_InputTranslateDescription}" Header="{DynamicResource Hotkey_InputTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.Keyboard_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.InputTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.InputTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.InputTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_InputTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_CrosswordTranslateDescription}" Header="{DynamicResource Hotkey_CrosswordTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.Keyboard_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.CrosswordTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.CrosswordTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.CrosswordTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_CrosswordTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_ReplaceTranslateDescription}" Header="{DynamicResource Hotkey_ReplaceTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.Replay_20_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.ReplaceTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.ReplaceTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.ReplaceTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_ReplaceTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_ScreenshotTranslateDescription}" Header="{DynamicResource Hotkey_ScreenshotTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ScreenCut_20_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.ScreenshotTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.ScreenshotTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.ScreenshotTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_ScreenshotTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_ImageTranslateDescription}" Header="{DynamicResource Hotkey_ImageTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.DrawImage_20_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.ImageTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.ImageTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.ImageTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_ImageTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_MouseHookTranslateDescription}" Header="{DynamicResource Hotkey_MouseHookTranslate}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.KeyboardMouse_16_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.MouseHookTranslateHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.MouseHookTranslateHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.MouseHookTranslateHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_MouseHookTranslate}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_SilentOcrDescription}" Header="{DynamicResource Hotkey_SilentOcr}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ScanTypeOff_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.SilentOcrHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.SilentOcrHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.SilentOcrHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_SilentOcr}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_SilentTtsDescription}" Header="{DynamicResource Hotkey_SilentTts}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.DesktopSpeaker_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.SilentTtsHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.SilentTtsHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.SilentTtsHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_SilentTts}" />
                    </ui:SettingsCard>

                    <ui:SettingsCard Description="{DynamicResource Hotkey_OcrDescription}" Header="{DynamicResource Hotkey_Ocr}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ScanType_24_Regular}" />
                        </ui:SettingsCard.HeaderIcon>
                        <control:HotkeyControl
                            DefaultHotkey="{Binding HotkeySettings.OcrHotkey.Default}"
                            Hotkey="{Binding HotkeySettings.OcrHotkey.Key}"
                            IsRegistered="{Binding HotkeySettings.OcrHotkey.IsConflict}"
                            WindowTitle="{DynamicResource Hotkey_Ocr}" />
                    </ui:SettingsCard>
                </control:CardGroup>

                <TextBlock
                    Margin="0,16,0,5"
                    Style="{DynamicResource BodyStrongTextBlockStyle}"
                    Text="{DynamicResource SoftwareHotkeys}" />

                <ui:SettingsCard Description="{DynamicResource Hotkey_CancelOrHideDescription}" Header="{DynamicResource Hotkey_CancelOrHide}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.LiveOff_20_Regular}" />
                    </ui:SettingsCard.HeaderIcon>
                    <control:HotkeyDisplay Keys="Escape" />
                </ui:SettingsCard>

                <ui:SettingsExpander Header="{DynamicResource Hotkey_MainWindow}">
                    <ui:SettingsExpander.Items>
                        <ui:SettingsCard Description="{DynamicResource Hotkey_ExitDescription}" Header="{DynamicResource Hotkey_Exit}">
                            <control:HotkeyDisplay Keys="Ctr+Shift+Q" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Description="{DynamicResource Hotkey_OpenSettingsDescription}" Header="{DynamicResource Hotkey_OpenSettings}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.OpenSettingsHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.OpenSettingsHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_OpenSettings}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_OpenHistory}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.OpenHistoryHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.OpenHistoryHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_OpenHistory}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_ToggleTopmost}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.ToggleTopmostHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.ToggleTopmostHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_ToggleTopmost}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Description="{DynamicResource Hotkey_ToggleColorThemeDescription}" Header="{DynamicResource Hotkey_ToggleColorTheme}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.ToggleColorThemeHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.ToggleColorThemeHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_ToggleColorTheme}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_ShowHideInputBox}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.HideInputHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.HideInputHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_ShowHideInputBox}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_SaveToVocabulary}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.SaveToVocabularyHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.SaveToVocabularyHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_SaveToVocabulary}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_HistoryNavigePrevious}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.HistoryNavigePreviousHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.HistoryNavigePreviousHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_HistoryNavigePrevious}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_HistoryNavigeNext}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.HistoryNavigeNextHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.HistoryNavigeNextHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_HistoryNavigeNext}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_AutoTranslate}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.AutoTranslateHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.AutoTranslateHotkey.Key}"
                                Type="MainWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_AutoTranslate}" />
                        </ui:SettingsCard>
                    </ui:SettingsExpander.Items>
                </ui:SettingsExpander>

                <ui:SettingsExpander Header="{DynamicResource Hotkey_OcrImTransWindow}">
                    <ui:SettingsExpander.Items>
                        <ui:SettingsCard Header="{DynamicResource Hotkey_ReExecuteOcr}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.ReExecuteOcrHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.ReExecuteOcrHotkey.Key}"
                                Type="OcrWindow,ImageTransWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_ReExecuteOcr}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Header="{DynamicResource Hotkey_SwitchImage}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.SwitchImageHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.SwitchImageHotkey.Key}"
                                Type="OcrWindow,ImageTransWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_SwitchImage}" />
                        </ui:SettingsCard>

                        <ui:SettingsCard Description="{DynamicResource Hotkey_QrCodeDescription}" Header="{DynamicResource Hotkey_QrCode}">
                            <control:HotkeyControl
                                DefaultHotkey="{Binding HotkeySettings.QrCodeHotkey.Default}"
                                Hotkey="{Binding HotkeySettings.QrCodeHotkey.Key}"
                                Type="OcrWindow"
                                ValidateKeyGesture="False"
                                WindowTitle="{DynamicResource Hotkey_QrCode}" />
                        </ui:SettingsCard>
                    </ui:SettingsExpander.Items>
                </ui:SettingsExpander>
            </ikw:SimpleStackPanel>
        </ui:ScrollViewerEx>
    </Grid>
</ui:Page>